# swupdate configuration for A/B updates with Golioth
# This configures swupdate to operate in local mode without web server

# Global settings
globals = {
	loglevel = 5;  # INFO level logging
	syslog = true;
	max_download_speed = 0;  # No download speed limit
}

# Hardware definition for A/B partitions
hardware = {
	bootloader = "uboot";
	copy = "a";  # Start with slot A as active
}

# A/B partition mapping
# Slot A: /dev/vdb1 (active)
# Slot B: /dev/vdb2 (inactive)
partitions = (
	{
		name = "rootfs";
		device = "/dev/vdb";
		type = "diskformat";
		size = 120971520;  # 120MB in bytes
		partitions = (
			{
				name = "rootfs_a";
				size = 60485760;  # 60MB
				start = 1048576;   # 1MB offset
			},
			{
				name = "rootfs_b";
				size = 60485760;  # 60MB
				start = 61534336; # After rootfs_a
			}
		);
	}
);

# Update source configuration - local IPC only
suricatta = {
	enable = false;  # Disable remote polling (Golioth handles this)
};

# IPC settings for local communication
ipc = {
	timeout = 10;
	socket_path = "/tmp/swupdate_ipc";
};

# Webserver disabled - Golioth is the only interface
webserver = {
	enable = false;
};

# Download settings
download = {
	retries = 3;
	timeout = 30;
};

# Logging configuration
logger = {
	level = 5;  # INFO level
	destination = "syslog";
};